-- by trip to get PO details, created by JimShen on Sep.01.2022

SELECT a.AACOD1,a.AATWHS,a.AAITM#,CHAR(a.AASER#) SN,a.AATQTY,a.AAEQP#,a.AAADAT,a.AAATIM,a.AATFR# as PO#

FROM DISTLIBQ.ACTAUDT a
WHERE a.AACOD1 IN ('RC') AND a.AAADAT BETWEEN 20220101 AND 20291231  and a.AASER# IN
(
SELECT t2.SN
FROM
(
SELECT  
t1.AACOD1,t1.AAFWHS,t1.AAITM#,CHAR(t1.AASER#) SN,t1.AATRP#, MAX(t1.AAADAT) as "DATE"

FROM DISTLIBQ.ACTAUDT t1
WHERE t1.AAADAT BETWEEN 20220101 AND 20220901 AND t1.AACOD1 in ('BT') AND t1.AAFWHS in ('232') AND t1.AATRP# IN ('43090','43206','43161','42523','43306','43090','43314','43315','43316')
GROUP BY 
t1.AACOD1,t1.AAFWHS,t1.AAITM#,CHAR(t1.AASER#),t1.AATRP#
) t2
)




----------------------------------------------------------------------------------------------------------------------------------------------------------------


-- ashley SH 1365 trips details
SELECT  
t1.AACOD1,t1.AAFWHS,t1.AAITM#,CHAR(t1.AASER#) SN,t1.AATRP#, MAX(t1.AAADAT) as "DATE"

FROM DISTLIBQ.ACTAUDT t1
WHERE t1.AAADAT BETWEEN 20220101 AND 20220901 AND t1.AACOD1 in ('BT') AND t1.AAFWHS in ('232') AND t1.AATRP# IN ('43090','43206','43161','42523','43306','43090','43314','43315','43316')
GROUP BY 
t1.AACOD1,t1.AAFWHS,t1.AAITM#,CHAR(t1.AASER#),t1.AATRP#