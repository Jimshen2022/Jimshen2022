-- Ashton daily shipped report, updated by JimShen on Oct.12.2021



(SELECT t4.INIVDT, t6.ITITNO, t4.INWHSE, t6.ITITCL, t6.ITSHQT, t2.UUCCIM, t7.XCUS#, t6.ITWHSE, t6.ITCSNO, t6.ITSPNO, T5.XNTRPN, T5.XNINVR, T5.XNORNO, 
t1.STACD, t2.CUBES, t4.INPONO, t1.CUSNM, t7.XFRGHT, t7.XTCONF, t7.XDSCNT, t6.ITPRIC,t1.CCTYN as CountryCode

FROM AFILELIB.ACUSMASJ t1, AFILELIB.ITMEXT t2, AMFLIBA.MBBZRES1 t3, AFILELIB.TSININA1 t4, AFILELIB.TSINXN t5, AFILELIB.TSITIN t6, AFILELIB.TSITXN t7
WHERE t4.INORNO = t7.XTORNO AND t7.XTORNO = t6.ITORNO AND t6.ITORNO = T5.XNORNO AND t4.ININVR = t7.XTINVR 
AND t7.XTINVR = t6.ITINVR AND t7.XTITNO = t6.ITITNO AND t6.ITCSNO = t1.CUSNO AND t6.ITITNO = t3.BZAITX 
AND t3.BZAITX = t2.ITNBR AND t4.INWHSE = t6.ITWHSE AND t6.ITINVR = T5.XNINVR AND t6.ITCSNO = t7.XCUS# 
AND t7.XCUS# = t4.INCSNO AND t7.XTITSQ = t6.ITITSQ AND t4.INRIDT = t7.XRIDAT AND t7.XRIDAT = t6.ITRIDT
AND ((t4.INWHSE='335') 
AND (t4.INIVDT>= int(substr(trim(char(CURRENT DATE - 15 days)),1,4)||substr(trim(char(CURRENT DATE - 15 days)),6,2)||substr(trim(char(CURRENT DATE - 15 days)),9,2)) 
And t4.INIVDT<= int(substr(trim(char(CURRENT DATE)),1,4)||substr(trim(char(CURRENT DATE)),6,2)||substr(trim(char(CURRENT DATE)),9,2))) AND (t6.ITSHQT>0))
ORDER BY t4.INIVDT,T5.XNTRPN)





-- Ashton daily shipped report, updated by JimShen on Oct.12.2021

SELECT t4.INIVDT, t6.ITITNO, t4.INWHSE, t6.ITITCL, t6.ITSHQT, t2.UUCCIM, t7.XCUS#, t6.ITWHSE, t6.ITCSNO, t6.ITSPNO, T5.XNTRPN, T5.XNINVR, T5.XNORNO, t1.STACD, t2.CUBES, t4.INPONO, t1.CUSNM, t7.XFRGHT, t7.XTCONF, t7.XDSCNT, t6.ITPRIC,t1.CCTYN as CountryCode

FROM AFILELIB.ACUSMASJ t1, AFILELIB.ITMEXT t2, AMFLIBA.MBBZRES1 t3, AFILELIB.TSININA1 t4, AFILELIB.TSINXN t5, AFILELIB.TSITIN t6, AFILELIB.TSITXN t7
WHERE t4.INORNO = t7.XTORNO AND t7.XTORNO = t6.ITORNO AND t6.ITORNO = T5.XNORNO AND t4.ININVR = t7.XTINVR AND t7.XTINVR = t6.ITINVR AND t7.XTITNO = t6.ITITNO AND t6.ITCSNO = t1.CUSNO AND t6.ITITNO = t3.BZAITX AND t3.BZAITX = t2.ITNBR AND t4.INWHSE = t6.ITWHSE AND t6.ITINVR = T5.XNINVR AND t6.ITCSNO = t7.XCUS# AND t7.XCUS# = t4.INCSNO AND t7.XTITSQ = t6.ITITSQ AND t4.INRIDT = t7.XRIDAT AND t7.XRIDAT = t6.ITRIDT AND ((t4.INWHSE='335') AND (t4.INIVDT>= 20210101 And t4.INIVDT<= (substr(trim(char(CURRENT DATE)),1,4)||substr(trim(char(CURRENT DATE)),6,2)||substr(trim(char(CURRENT DATE)),9,2))) AND (t6.ITSHQT>0))
ORDER BY t4.INIVDT,T5.XNTRPN


-- BI DATA

SELECT TSININA1.INIVDT, TSITIN.ITITNO, TSININA1.INWHSE, TSITIN.ITITCL, TSITIN.ITSHQT, ITMEXT.UUCCIM, TSITXN.XCUS#, 
TSITIN.ITWHSE, TSITIN.ITCSNO, TSITIN.ITSPNO, TSINXN.XNTRPN, TSINXN.XNINVR, TSINXN.XNORNO, ACUSMASJ.STACD, ITMEXT.CUBES, 
TSININA1.INPONO, ACUSMASJ.CUSNM, TSITXN.XFRGHT, TSITXN.XTCONF, TSITXN.XDSCNT, TSITIN.ITPRIC,ACUSMASJ.CCTYN as CountryCode

FROM D20ACF9V.AFILELIB.ACUSMASJ ACUSMASJ, D20ACF9V.AFILELIB.ITMEXT ITMEXT, D20ACF9V.AMFLIBA.MBBZRES1 MBBZRES1, D20ACF9V.AFILELIB.TSININA1 TSININA1, D20ACF9V.AFILELIB.TSINXN TSINXN, D20ACF9V.AFILELIB.TSITIN TSITIN, D20ACF9V.AFILELIB.TSITXN TSITXN

WHERE TSININA1.INORNO = TSITXN.XTORNO AND TSITXN.XTORNO = TSITIN.ITORNO AND TSITIN.ITORNO = TSINXN.XNORNO AND TSININA1.ININVR = TSITXN.XTINVR 
AND TSITXN.XTINVR = TSITIN.ITINVR AND TSITXN.XTITNO = TSITIN.ITITNO AND TSITIN.ITCSNO = ACUSMASJ.CUSNO AND TSITIN.ITITNO = MBBZRES1.BZAITX 
AND MBBZRES1.BZAITX = ITMEXT.ITNBR AND TSININA1.INWHSE = TSITIN.ITWHSE AND TSITIN.ITINVR = TSINXN.XNINVR AND TSITIN.ITCSNO = TSITXN.XCUS# 
AND TSITXN.XCUS# = TSININA1.INCSNO AND TSITXN.XTITSQ = TSITIN.ITITSQ AND TSININA1.INRIDT = TSITXN.XRIDAT AND TSITXN.XRIDAT = TSITIN.ITRIDT 
AND ((TSININA1.INWHSE='335') AND (TSININA1.INIVDT>= 20210101 And TSININA1.INIVDT<= int(substr(trim(char(CURRENT DATE)),1,4)||substr(trim(char(CURRENT DATE)),6,2)||substr(trim(char(CURRENT DATE)),9,2))) AND (TSITIN.ITSHQT>0))
ORDER BY TSININA1.INIVDT,TSINXN.XNTRPN